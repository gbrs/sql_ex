https://itresume.ru/problems?tags=SQL&page=1&complexity=1

[Тестовое Альфа-банк] Покупки товара после 10 октября
SELECT
  COUNT(DISTINCT user_id)
FROM
  Purchases
WHERE
  created_at >= '2021-10-10'
  AND sku_id = 5

[Тестовое Тинькофф] Недозвонившиеся клиенты
SELECT
  start_dttm date,
  last_nm,
  first_nm,
  middle_nm
FROM
  tinkoff.Calls cll
  LEFT JOIN tinkoff.Customers cst USING (customer_id)
WHERE
  cll.dozv_flg = 0
  AND start_dttm = '2019-05-29'


Найти округа, в которых не было покупок
WITH FAR_COUNTY AS (
  SELECT
    COUNTY_CODE
  FROM
    COUNTY

  EXCEPT

  SELECT
    DISTINCT COUNTY_CODE
  FROM
    C_ORDERS
    INNER JOIN CUSTOMER USING(ID_CUSTOMER)
)

SELECT
  NAME AS name
FROM
  FAR_COUNTY
  INNER JOIN COUNTY USING (COUNTY_CODE)


Отфильтрованные продажи в период дат
SELECT
  LEFT(CAST(ord_datetime AS VARCHAR), 10) ord_date,
  COUNT(*) cnt
FROM
  Orders
WHERE
  ord_datetime BETWEEN '2019-10-25' AND '2019-11-02'
GROUP BY
  ord_date
HAVING
  COUNT(*) > 5
ORDER BY
  ord_date


Режим хранения анализов
SELECT
  ord.ord_id,
  ord.ord_an,
  anl.an_name,
  grp.gr_temp
FROM
  Orders ord
  INNER JOIN Analysis anl ON ord.ord_an = anl.an_id
  INNER JOIN Groups grp ON anl.an_group = grp.gr_id
WHERE
  grp.gr_temp = 22
ORDER BY
  ord.ord_id


Фильтрация по нескольким условиям
SELECT
  an_name,
  an_price
FROM
  Analysis
WHERE
  (LOWER(an_name) LIKE '%anti%'
   OR LOWER(an_name) LIKE '%кровь%')
  AND an_price < 1000
ORDER BY
  an_price DESC

