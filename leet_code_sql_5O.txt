Порешать те запросы, которые я решил в пандасе, чтоб не "путались"
'Sorting and Grouping' +


176. Second Highest Salary
SELECT
  MAX(salary) SecondHighestSalary
FROM
  Employee
WHERE
  salary != (SELECT MAX(salary) FROM Employee)


196. Delete Duplicate Emails
DELETE
  p1
FROM
  Person as p1,
  Person as p2
WHERE
  p1.Email = p2.Email
  AND p1.Id > p2.Id;


197. Rising Temperature
SELECT
  w2.id
FROM
  Weather w1
  INNER JOIN Weather w2
    ON w1.recordDate + INTERVAL 1 DAY = w2.recordDate
    AND w2.temperature > w1.temperature


570. Managers with at Least 5 Direct Reports
SELECT
  e1.name
FROM
  Employee e1
  INNER JOIN Employee e2 ON e2.managerId = e1.id
GROUP BY
  e1.id
HAVING
  COUNT(*) >= 5


577. Employee Bonus
SELECT
  name,
  bonus
FROM
  Employee e
  LEFT JOIN Bonus b USING (empId)
WHERE
  bonus < 1000
  OR bonus IS NULL


584. Find Customer Referee
SELECT
  name
FROM
  Customer
WHERE
  referee_id  != 2
  OR referee_id is NULL


595. Big Countries
SELECT
  name,
  population,
  area
FROM
  World
WHERE
  area >= 3000000
  OR population >= 25000000


596. Classes More Than 5 Students
SELECT
  class
FROM
  Courses
GROUP BY
  class
HAVING
  COUNT(student) >= 5


610. Triangle Judgement
SELECT
  *,
  CASE
    WHEN (x + y > z) AND (x < y + z) AND (x + z > y)
    THEN 'Yes'
    ELSE 'No'
    END triangle
FROM
  Triangle


619. Biggest Single Number
SELECT
  MAX(num) num
FROM
  (SELECT
    num
  FROM
    MyNumbers
  GROUP BY
    num
  HAVING
    COUNT(*) = 1) t


620. Not Boring Movies
SELECT
  *
FROM
  Cinema
WHERE
  id % 2 = 1
  and description != 'boring'
ORDER BY
  rating DESC


626. Exchange Seats
SELECT
  CASE
    WHEN (SELECT MAX(id) FROM Seat) % 2 = 1 AND id = (SELECT MAX(id) FROM Seat) THEN id
    WHEN id % 2 = 1 THEN id + 1
    ELSE id - 1
    END id,
  student
FROM
  Seat
ORDER BY
  id


1068. Product Sales Analysis I
SELECT
  product_name,
  year,
  price
FROM
  Sales
  INNER JOIN Product USING (product_id)


1075. Project Employees I
SELECT
  project_id,
  ROUND(AVG(experience_years), 2) average_years
FROM
  Project
  INNER JOIN Employee USING (employee_id)
GROUP BY
  project_id


1141. User Activity for the Past 30 Days I
SELECT
  activity_date day,
  COUNT(DISTINCT user_id) active_users
FROM
  Activity
WHERE
  activity_date BETWEEN '2019-07-27' - INTERVAL 29 DAY AND '2019-07-27'
GROUP BY
  activity_date


1148. Article Views I
SELECT
  DISTINCT author_id id
FROM
  Views
WHERE
  author_id = viewer_id
ORDER BY
  id


1211. Queries Quality and Percentage
-- MySQL
SELECT
  query_name,
  ROUND(AVG(rating / position), 2) quality,
  ROUND(100.0 * SUM(rating < 3) / COUNT(query_name), 2) poor_query_percentage
FROM
  Queries
GROUP BY
  query_name


1211-2. Queries Quality and Percentage
-- PosgreSQL
SELECT
  query_name,
  ROUND(AVG(1.0 * rating / position), 2) quality,
  ROUND(100.0 * COUNT(query_name) FILTER(WHERE rating < 3) / COUNT(query_name), 2) poor_query_percentage
FROM
  Queries
GROUP BY
  query_name


1251. Average Selling Price
SELECT
  p.product_id,
  COALESCE(ROUND(SUM(units * price) / SUM(units), 2), 0) average_price
FROM
  Prices p
  LEFT JOIN UnitsSold us ON (
      p.product_id = us.product_id
      AND purchase_date BETWEEN start_date AND end_date
  )
GROUP BY
  product_id



1280. Students and Examinations
SELECT
  student_id,
  student_name,
  subject_name,
  COUNT(Examinations.subject_name) AS attended_exams
FROM
  Students
  CROSS JOIN Subjects
  LEFT JOIN Examinations USING (student_id, subject_name)
GROUP BY
  student_id,
  student_name,
  subject_name
ORDER BY
  student_id,
  subject_name


1327. List the Products Ordered in a Period
SELECT
  product_name,
  SUM(unit) unit
FROM
  Products p
  INNER JOIN Orders o USING(product_id)
WHERE
  order_date BETWEEN '2020-02-01' AND '2020-02-29'
GROUP BY
  product_id
HAVING
  SUM(unit) >= 100


1341. Movie Rating
(
  SELECT
    name AS results
  FROM
    MovieRating
    INNER JOIN Users USING(user_id)
  GROUP BY
    user_id
  ORDER BY
    COUNT(*) DESC,
    name
  LIMIT
    1
)

UNION ALL

(
  SELECT
    title AS results
  FROM
    MovieRating
    INNER JOIN Movies USING(movie_id)
  WHERE
    YEAR(created_at) = 2020
    AND MONTH(created_at) = 2
  GROUP BY
    movie_id
  ORDER BY
    AVG(rating) DESC,
    title
  LIMIT
    1
)


1378. Replace Employee ID With The Unique Identifier
SELECT
  unique_id,
  name
FROM
  Employees
  LEFT JOIN EmployeeUNI USING(id)


1484. Group Sold Products By The Date
SELECT
  sell_date,
  COUNT(DISTINCT product) num_sold,
  GROUP_CONCAT(DISTINCT product ORDER BY product) products
FROM
  Activities
GROUP BY
  sell_date
ORDER BY
  sell_date


1517. Find Users With Valid E-Mails
SELECT
  *
FROM
  Users
WHERE
  mail REGEXP '^[A-Za-z]{1}[_0-9a-zA-Z.-]*@leetcode\\.com$'


1527. Patients With a Condition
SELECT
  *
FROM
  Patients
WHERE
  conditions LIKE 'DIAB1%'
  or conditions LIKE '% DIAB1%'


1581. Customer Who Visited but Did Not Make Any Transactions
SELECT
  v.customer_id,
  COUNT(*) count_no_trans
FROM
  Visits v
  LEFT JOIN Transactions t USING(visit_id)
WHERE
  amount IS NULL
GROUP BY
  v.customer_id


1633. Percentage of Users Attended a Contest
SELECT
  contest_id,
  ROUND(100.0 * COUNT(DISTINCT user_id) / (SELECT COUNT(*) FROM Users), 2) percentage
FROM
  Users
  INNER JOIN Register USING (user_id)
GROUP BY
  contest_id
ORDER BY
  percentage DESC,
  contest_id


1661. Average Time of Process per Machine
WITH
  start_times as (
    SELECT
      *
    FROM
      Activity
    WHERE
      activity_type = 'start'
  ),

  end_times as (
    SELECT
      *
    FROM
      Activity
    WHERE
      activity_type = 'end'
  )

SELECT
  st.machine_id,
  ROUND(AVG(et.timestamp - st.timestamp), 3) processing_time
FROM
  start_times st
  INNER JOIN end_times et USING (machine_id, process_id)
GROUP BY
  st.machine_id


1661-2. Average Time of Process per Machine
SELECT
  a1.machine_id,
  ROUND(AVG(a2.timestamp - a1.timestamp), 3) processing_time
FROM
  Activity a1
  INNER JOIN Activity a2
    ON a1.machine_id = a2.machine_id
    AND a1.process_id = a2.process_id
    AND a1.activity_type = 'start'
    AND a2.activity_type = 'end'
GROUP BY
  a1.machine_id


1667. Fix Names in a Table
SELECT
  user_id,
  CONCAT(
      UPPER(SUBSTRING(`name`, 1, 1)),
      LOWER(SUBSTRING(`name` FROM 2))
  ) name
FROM
  Users
ORDER BY
  user_id


1683. Invalid Tweets
SELECT
  tweet_id
FROM
  Tweets
WHERE
  LENGTH(content) > 15


1731. The Number of Employees Which Report to Each Employee
SELECT
  e1.employee_id,
  e1.name,
  COUNT(e2.employee_id) reports_count,
  ROUND(AVG(e2.age)) average_age
FROM
  Employees e1
  INNER JOIN Employees e2 ON e1.employee_id = e2.reports_to
GROUP BY
  e1.employee_id
ORDER BY
  e1.employee_id


1757. Recyclable and Low Fat Products
SELECT
  product_id
FROM
  Products
WHERE
  low_fats = 'Y'
  AND recyclable = 'Y'


1789. Primary Department for Each Employee
(
SELECT
  employee_id,
  MAX(department_id) department_id
FROM
  Employee
GROUP BY
  employee_id
HAVING
  COUNT(*) = 1
)

UNION

(
SELECT
  employee_id,
  department_id
FROM
  Employee
WHERE
  primary_flag = 'Y'
)


1907. Count Salary Categories
WITH
  category_table as (
    SELECT
      *,
      CASE
        WHEN income < 20000 THEN "Low Salary"
        WHEN income > 50000 THEN "High Salary"
        ELSE "Average Salary"
        END category
    FROM
      Accounts
  ),

  category_count as (
    SELECT
      category,
      COUNT(*)
    FROM
      category_table
    GROUP BY
      category
  ),

  category_name as (
    SELECT
      "Low Salary",
      "Average Salary",
      "High Salary"
      as category
  )


1978. Employees Whose Manager Left the Company
SELECT
  employee_id
FROM
  Employees
WHERE
  salary < 30000
  AND manager_id NOT IN (SELECT DISTINCT employee_id FROM Employees)
ORDER BY
  employee_id


1978-2. Employees Whose Manager Left the Company
SELECT
  employee_id
FROM
  Employees e1
WHERE
  salary < 30000
  AND NOT EXISTS (SELECT * FROM Employees e2 WHERE ((e1.manager_id = e2.employee_id) OR (e1.manager_id IS NULL)))
ORDER BY
  employee_id



2356. Number of Unique Subjects Taught by Each Teacher
SELECT
  teacher_id,
  COUNT(DISTINCT subject_id) cnt
FROM
  Teacher
GROUP BY
  teacher_id



